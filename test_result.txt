============================= test session starts ==============================
platform linux -- Python 3.12.0, pytest-8.3.3, pluggy-1.5.0
rootdir: /home/pimentel/Workspace/pepperpy
configfile: pyproject.toml
testpaths: tests
plugins: cov-6.0.0, anyio-4.6.2.post1, mock-3.14.0, asyncio-0.24.0
asyncio: mode=Mode.AUTO, default_loop_scope=function
collected 267 items

tests/ai/agents/test_agent_types.py ................                     [  5%]
tests/ai/agents/test_analysis.py ........                                [  8%]
tests/ai/agents/test_architect.py ......                                 [ 11%]
tests/ai/agents/test_development.py .....                                [ 13%]
tests/ai/agents/test_factory.py ........                                 [ 16%]
tests/ai/agents/test_interfaces.py .................                     [ 22%]
tests/ai/agents/test_management.py ........                              [ 25%]
tests/ai/agents/test_qa.py .......                                       [ 28%]
tests/ai/agents/test_research.py ........                                [ 31%]
tests/ai/agents/test_researcher.py ......                                [ 33%]
tests/ai/agents/test_review.py ......                                    [ 35%]
tests/ai/agents/test_reviewer.py ......                                  [ 37%]
tests/ai/agents/test_specialized.py ..............                       [ 43%]
tests/ai/agents/test_specialized_extra.py ......                         [ 45%]
tests/ai/agents/test_team.py ........                                    [ 48%]
tests/ai/agents/test_team_types.py ..........                            [ 52%]
tests/ai/chat/test_chat_config.py .........                              [ 55%]
tests/ai/chat/test_chat_types.py ...............                         [ 61%]
tests/ai/chat/test_conversation.py ..........                            [ 64%]
tests/ai/test_cache.py .........                                         [ 68%]
tests/core/cache/test_distributed.py ..........                          [ 71%]
tests/files/handlers/test_audio.py .FFFF.                                [ 74%]
tests/files/handlers/test_binary.py ..                                   [ 74%]
tests/files/handlers/test_csv.py .....FF...FF.F.F                        [ 80%]
tests/files/handlers/test_file_handler_base.py ....                      [ 82%]
tests/files/handlers/test_json.py ....                                   [ 83%]
tests/files/handlers/test_markdown.py ..                                 [ 84%]
tests/files/handlers/test_optimizer.py .....                             [ 86%]
tests/files/handlers/test_pdf.py ....                                    [ 88%]
tests/files/handlers/test_text.py ....                                   [ 89%]
tests/files/handlers/test_yaml.py ......                                 [ 91%]
tests/files/test_file_operations.py .....                                [ 93%]
tests/files/test_manager.py .......                                      [ 96%]
tests/test_module.py ..........                                          [100%]

=================================== FAILURES ===================================
___________________________ test_audio_handler_write ___________________________

audio_handler = <pepperpy.files.handlers.audio.AudioFileHandler object at 0x7f5b20c1bb90>

    @pytest.mark.asyncio
    async def test_audio_handler_write(audio_handler):
        """Test audio handler write operation"""
        await audio_handler.initialize()
    
        test_file = Path("/test/test.mp3")
        test_content = b"test audio content"
        content = FileContent(
            content=test_content,
            metadata=FileMetadata(
                name="test.mp3",
                mime_type="audio/mpeg",
                path=test_file,
                type="audio",
                extension=".mp3",
                format="binary",
                size=len(test_content),
            ),
        )
    
        mock_path = Mock(spec=Path)
        mock_path.exists.return_value = True
        mock_path.parent.exists.return_value = True
        mock_path.name = "test.mp3"
        mock_path.suffix = ".mp3"
>       mock_path.__str__.return_value = str(test_file)
E       AttributeError: 'method-wrapper' object has no attribute 'return_value'

tests/files/handlers/test_audio.py:71: AttributeError
______________________ test_audio_handler_invalid_content ______________________

audio_handler = <pepperpy.files.handlers.audio.AudioFileHandler object at 0x7f5b20ab4b00>

    @pytest.mark.asyncio
    async def test_audio_handler_invalid_content(audio_handler):
        """Test audio handler with invalid content"""
        await audio_handler.initialize()
    
        test_file = Path("/test/test.mp3")
        content = FileContent(
            content="invalid content type",  # Should be bytes
            metadata=FileMetadata(
                name="test.mp3",
                mime_type="audio/mpeg",
                path=test_file,
                type="audio",
                extension=".mp3",
                format="binary",
                size=0,
            ),
        )
    
        mock_path = Mock(spec=Path)
        mock_path.exists.return_value = True
        mock_path.parent.exists.return_value = True
        mock_path.name = "test.mp3"
        mock_path.suffix = ".mp3"
    
        with pytest.raises(FileError, match="Invalid binary content"):
>           await audio_handler.write(mock_path, content)

tests/files/handlers/test_audio.py:107: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <pepperpy.files.handlers.audio.AudioFileHandler object at 0x7f5b20ab4b00>
path = <Mock spec='Path' id='140029366848160'>
content = FileContent(content='invalid content type', metadata=FileMetadata(name='test.mp3', mime_type='audio/mpeg', path=PosixPath('/test/test.mp3'), type='audio', extension='.mp3', format='binary', size=0, metadata={}))
kwargs = {}

    async def write(self, path: Path, content: FileContent, **kwargs: Dict[str, Any]) -> None:
        """Write audio file content"""
        if not isinstance(content.content, bytes):
>           raise FileError("Invalid audio content")
E           pepperpy.files.exceptions.FileError: Invalid audio content

pepperpy/files/handlers/audio.py:32: FileError

During handling of the above exception, another exception occurred:

audio_handler = <pepperpy.files.handlers.audio.AudioFileHandler object at 0x7f5b20ab4b00>

    @pytest.mark.asyncio
    async def test_audio_handler_invalid_content(audio_handler):
        """Test audio handler with invalid content"""
        await audio_handler.initialize()
    
        test_file = Path("/test/test.mp3")
        content = FileContent(
            content="invalid content type",  # Should be bytes
            metadata=FileMetadata(
                name="test.mp3",
                mime_type="audio/mpeg",
                path=test_file,
                type="audio",
                extension=".mp3",
                format="binary",
                size=0,
            ),
        )
    
        mock_path = Mock(spec=Path)
        mock_path.exists.return_value = True
        mock_path.parent.exists.return_value = True
        mock_path.name = "test.mp3"
        mock_path.suffix = ".mp3"
    
>       with pytest.raises(FileError, match="Invalid binary content"):
E       AssertionError: Regex pattern did not match.
E        Regex: 'Invalid binary content'
E        Input: 'Invalid audio content'

tests/files/handlers/test_audio.py:106: AssertionError
____________________ test_audio_handler_unsupported_format _____________________

audio_handler = <pepperpy.files.handlers.audio.AudioFileHandler object at 0x7f5b20ab6270>

    @pytest.mark.asyncio
    async def test_audio_handler_unsupported_format(audio_handler):
        """Test audio handler with unsupported format"""
        await audio_handler.initialize()
    
        mock_path = Mock(spec=Path)
        mock_path.exists.return_value = True
        mock_path.is_file.return_value = True
        mock_path.name = "test.ogg"
        mock_path.suffix = ".ogg"
    
        with pytest.raises(FileError, match="Unsupported file extension"):
>           await audio_handler.read(mock_path)

tests/files/handlers/test_audio.py:122: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
pepperpy/files/handlers/audio.py:16: in read
    content = await super().read(path, **kwargs)
pepperpy/files/handlers/binary.py:29: in read
    self._validate_path(path)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <pepperpy.files.handlers.audio.AudioFileHandler object at 0x7f5b20ab6270>
path = <Mock spec='Path' id='140029366846576'>

    def _validate_path(self, path: Path) -> None:
        """Validate file path.
    
        Args:
            path: File path
    
        Raises:
            FileError: If path is invalid
        """
        if path.suffix not in self.config.allowed_extensions:
>           raise FileError(f"Invalid file extension: {path.suffix}")
E           pepperpy.files.exceptions.FileError: Invalid file extension: .ogg

pepperpy/files/handlers/base.py:74: FileError

During handling of the above exception, another exception occurred:

audio_handler = <pepperpy.files.handlers.audio.AudioFileHandler object at 0x7f5b20ab6270>

    @pytest.mark.asyncio
    async def test_audio_handler_unsupported_format(audio_handler):
        """Test audio handler with unsupported format"""
        await audio_handler.initialize()
    
        mock_path = Mock(spec=Path)
        mock_path.exists.return_value = True
        mock_path.is_file.return_value = True
        mock_path.name = "test.ogg"
        mock_path.suffix = ".ogg"
    
>       with pytest.raises(FileError, match="Unsupported file extension"):
E       AssertionError: Regex pattern did not match.
E        Regex: 'Unsupported file extension'
E        Input: 'Invalid file extension: .ogg'

tests/files/handlers/test_audio.py:121: AssertionError
_______________________ test_audio_handler_empty_content _______________________

audio_handler = <pepperpy.files.handlers.audio.AudioFileHandler object at 0x7f5b20ab6c90>

    @pytest.mark.asyncio
    async def test_audio_handler_empty_content(audio_handler):
        """Test audio handler with empty content"""
        await audio_handler.initialize()
    
        test_file = Path("/test/test.mp3")
        content = FileContent(
            content=b"",  # Empty content
            metadata=FileMetadata(
                name="test.mp3",
                mime_type="audio/mpeg",
                path=test_file,
                type="audio",
                extension=".mp3",
                format="binary",
                size=0
            ),
        )
    
        mock_path = Mock(spec=Path)
        mock_path.exists.return_value = True
        mock_path.parent.exists.return_value = True
        mock_path.name = "test.mp3"
        mock_path.suffix = ".mp3"
>       mock_path.__str__.return_value = str(test_file)
E       AttributeError: 'method-wrapper' object has no attribute 'return_value'

tests/files/handlers/test_audio.py:149: AttributeError
_________________ test_csv_handler_read_with_custom_delimiter __________________

csv_handler = <pepperpy.files.handlers.csv.CSVFileHandler object at 0x7f5b20ad3b90>

    @pytest.mark.asyncio
    async def test_csv_handler_read_with_custom_delimiter(csv_handler):
        """Test CSV handler read operation with custom delimiter"""
        await csv_handler.initialize()
    
        test_content = "header1;header2\nvalue1;value2\n"
        mock_path = Mock(spec=Path)
        mock_path.exists.return_value = True
        mock_path.is_file.return_value = True
        mock_path.stat.return_value = Mock(st_size=len(test_content))
        mock_path.name = "test.csv"
        mock_path.suffix = ".csv"
    
        # Create a list to simulate DictReader rows
        mock_rows = [{"header1": "value1", "header2": "value2"}]
        mock_reader = Mock()
        mock_reader.fieldnames = ["header1", "header2"]
>       mock_reader.__iter__.return_value = iter(mock_rows)

tests/files/handlers/test_csv.py:182: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <Mock id='140029368317184'>, name = '__iter__'

    def __getattr__(self, name):
        if name in {'_mock_methods', '_mock_unsafe'}:
            raise AttributeError(name)
        elif self._mock_methods is not None:
            if name not in self._mock_methods or name in _all_magics:
                raise AttributeError("Mock object has no attribute %r" % name)
        elif _is_magic(name):
>           raise AttributeError(name)
E           AttributeError: __iter__

../../.pyenv/versions/3.12.0/lib/python3.12/unittest/mock.py:660: AttributeError
_________________ test_csv_handler_write_with_custom_delimiter _________________

csv_handler = <pepperpy.files.handlers.csv.CSVFileHandler object at 0x7f5b20ad0260>

    @pytest.mark.asyncio
    async def test_csv_handler_write_with_custom_delimiter(csv_handler):
        """Test CSV handler write operation with custom delimiter"""
        await csv_handler.initialize()
    
        test_file = Path("/test/test.csv")
        csv_data = [{"header1": "value1", "header2": "value2"}]
        content = FileContent(
            content=csv_data,
            metadata=FileMetadata(
                name="test.csv",
                mime_type="text/csv",
                path=test_file,
                type="text/csv",
                extension=".csv",
                format="utf-8",
                size=100,
            ),
        )
    
        mock_path = Mock(spec=Path)
        mock_path.exists.return_value = True
        mock_path.parent.exists.return_value = True
        mock_path.name = "test.csv"
        mock_path.suffix = ".csv"
    
        m = mock_open()
        with patch("builtins.open", m), \
             patch("csv.DictWriter") as mock_dict_writer:
            # Configure mock DictWriter
            mock_writer_instance = Mock()
            mock_dict_writer.return_value = mock_writer_instance
    
            await csv_handler.write(mock_path, content, delimiter=";")
    
            # Verify DictWriter was called with correct parameters
            _, kwargs = mock_dict_writer.call_args
>           assert kwargs.get("delimiter") == ";"
E           AssertionError: assert None == ';'
E            +  where None = <built-in method get of dict object at 0x7f5b20b3e700>('delimiter')
E            +    where <built-in method get of dict object at 0x7f5b20b3e700> = {'fieldnames': dict_keys(['header1', 'header2'])}.get

tests/files/handlers/test_csv.py:236: AssertionError
__________________ test_csv_handler_read_with_custom_encoding __________________

csv_handler = <pepperpy.files.handlers.csv.CSVFileHandler object at 0x7f5b20bc3800>

    @pytest.mark.asyncio
    async def test_csv_handler_read_with_custom_encoding(csv_handler):
        """Test CSV handler read operation with custom encoding"""
        await csv_handler.initialize()
    
        test_content = "header1,header2\nvalue1,value2\n"
        mock_path = Mock(spec=Path)
        mock_path.exists.return_value = True
        mock_path.is_file.return_value = True
        mock_path.stat.return_value = Mock(st_size=len(test_content))
        mock_path.name = "test.csv"
        mock_path.suffix = ".csv"
    
        # Create a list to simulate DictReader rows
        mock_rows = [{"header1": "value1", "header2": "value2"}]
        mock_reader = Mock()
        mock_reader.fieldnames = ["header1", "header2"]
>       mock_reader.__iter__.return_value = iter(mock_rows)

tests/files/handlers/test_csv.py:333: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <Mock id='140029367946752'>, name = '__iter__'

    def __getattr__(self, name):
        if name in {'_mock_methods', '_mock_unsafe'}:
            raise AttributeError(name)
        elif self._mock_methods is not None:
            if name not in self._mock_methods or name in _all_magics:
                raise AttributeError("Mock object has no attribute %r" % name)
        elif _is_magic(name):
>           raise AttributeError(name)
E           AttributeError: __iter__

../../.pyenv/versions/3.12.0/lib/python3.12/unittest/mock.py:660: AttributeError
_________________ test_csv_handler_write_with_custom_encoding __________________

csv_handler = <pepperpy.files.handlers.csv.CSVFileHandler object at 0x7f5b212ce870>

    @pytest.mark.asyncio
    async def test_csv_handler_write_with_custom_encoding(csv_handler):
        """Test CSV handler write operation with custom encoding"""
        await csv_handler.initialize()
    
        test_file = Path("/test/test.csv")
        csv_data = [{"header1": "value1", "header2": "value2"}]
        content = FileContent(
            content=csv_data,
            metadata=FileMetadata(
                name="test.csv",
                mime_type="text/csv",
                path=test_file,
                type="text/csv",
                extension=".csv",
                format="utf-16",
                size=100,
            ),
        )
    
        mock_path = Mock(spec=Path)
        mock_path.exists.return_value = True
        mock_path.parent.exists.return_value = True
        mock_path.name = "test.csv"
        mock_path.suffix = ".csv"
    
        m = mock_open()
        with patch("builtins.open", m) as mock_open_call:
            await csv_handler.write(mock_path, content, encoding="utf-16")
    
            # Verify open was called with correct encoding
            _, kwargs = mock_open_call.call_args
>           assert kwargs.get("encoding") == "utf-16"
E           AssertionError: assert 'utf-8' == 'utf-16'
E             
E             - utf-16
E             + utf-8

tests/files/handlers/test_csv.py:379: AssertionError
_____________________ test_csv_handler_write_with_quoting ______________________

csv_handler = <pepperpy.files.handlers.csv.CSVFileHandler object at 0x7f5b20b9e840>

    @pytest.mark.asyncio
    async def test_csv_handler_write_with_quoting(csv_handler):
        """Test CSV handler write operation with fields requiring quotes"""
        await csv_handler.initialize()
    
        test_file = Path("/test/test.csv")
        csv_data = [{"header1": "value,1", "header2": "value,2"}]
        content = FileContent(
            content=csv_data,
            metadata=FileMetadata(
                name="test.csv",
                mime_type="text/csv",
                path=test_file,
                type="text/csv",
                extension=".csv",
                format="utf-8",
                size=100,
            ),
        )
    
        mock_path = Mock(spec=Path)
        mock_path.exists.return_value = True
        mock_path.parent.exists.return_value = True
        mock_path.name = "test.csv"
        mock_path.suffix = ".csv"
    
        m = mock_open()
        with patch("builtins.open", m), \
             patch("csv.DictWriter") as mock_dict_writer:
            # Configure mock DictWriter
            mock_writer_instance = Mock()
            mock_dict_writer.return_value = mock_writer_instance
    
            await csv_handler.write(mock_path, content)
    
            # Verify DictWriter was called with correct parameters
            _, kwargs = mock_dict_writer.call_args
>           assert kwargs.get("quoting") == csv.QUOTE_MINIMAL
E           AssertionError: assert None == 0
E            +  where None = <built-in method get of dict object at 0x7f5b20abf0c0>('quoting')
E            +    where <built-in method get of dict object at 0x7f5b20abf0c0> = {'fieldnames': dict_keys(['header1', 'header2'])}.get
E            +  and   0 = csv.QUOTE_MINIMAL

tests/files/handlers/test_csv.py:440: AssertionError
_____________________ test_csv_handler_write_invalid_path ______________________

csv_handler = <pepperpy.files.handlers.csv.CSVFileHandler object at 0x7f5b20c28890>

    @pytest.mark.asyncio
    async def test_csv_handler_write_invalid_path(csv_handler):
        """Test CSV handler write operation with invalid path"""
        await csv_handler.initialize()
    
        test_file = Path("/test/test.csv")
        csv_data = [{"header1": "value1", "header2": "value2"}]
        content = FileContent(
            content=csv_data,
            metadata=FileMetadata(
                name="test.csv",
                mime_type="text/csv",
                path=test_file,
                type="text/csv",
                extension=".csv",
                format="utf-8",
                size=100,
            ),
        )
    
        mock_path = Mock(spec=Path)
        mock_path.exists.return_value = True
        mock_path.parent.exists.return_value = False
        mock_path.name = "test.csv"
        mock_path.suffix = ".csv"
        mock_path.parent = Mock(spec=Path, exists=Mock(return_value=False))
    
        # Don't mock open() here since we want to test path validation
        with pytest.raises(FileError) as exc_info:
            await csv_handler.write(mock_path, content)
>       assert "Parent directory does not exist" in str(exc_info.value)
E       AssertionError: assert 'Parent directory does not exist' in 'Failed to write file: expected str, bytes or os.PathLike object, not Mock'
E        +  where 'Failed to write file: expected str, bytes or os.PathLike object, not Mock' = str(FileError('Failed to write file: expected str, bytes or os.PathLike object, not Mock'))
E        +    where FileError('Failed to write file: expected str, bytes or os.PathLike object, not Mock') = <ExceptionInfo FileError('Failed to write file: expected str, bytes or os.PathLike object, not Mock') tblen=2>.value

tests/files/handlers/test_csv.py:488: AssertionError
=============================== warnings summary ===============================
../../.cache/pypoetry/virtualenvs/pepperpy-gKIqzKmw-py3.12/lib/python3.12/site-packages/pydantic/_internal/_config.py:295
../../.cache/pypoetry/virtualenvs/pepperpy-gKIqzKmw-py3.12/lib/python3.12/site-packages/pydantic/_internal/_config.py:295
  /home/pimentel/.cache/pypoetry/virtualenvs/pepperpy-gKIqzKmw-py3.12/lib/python3.12/site-packages/pydantic/_internal/_config.py:295: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.10/migration/
    warnings.warn(DEPRECATION_MESSAGE, DeprecationWarning)

tests/core/cache/test_cache_base.py:10
  /home/pimentel/Workspace/pepperpy/tests/core/cache/test_cache_base.py:10: PytestCollectionWarning: cannot collect test class 'TestCache' because it has a __init__ constructor (from: tests/core/cache/test_cache_base.py)
    class TestCache(BaseCache):

tests/core/cache/test_cache_base.py:47
  /home/pimentel/Workspace/pepperpy/tests/core/cache/test_cache_base.py:47: PytestCollectionWarning: cannot collect test class 'TestProvider' because it has a __init__ constructor (from: tests/core/cache/test_cache_base.py)
    class TestProvider(CacheProvider):

tests/files/handlers/test_file_handler_base.py:13
  /home/pimentel/Workspace/pepperpy/tests/files/handlers/test_file_handler_base.py:13: PytestCollectionWarning: cannot collect test class 'TestHandler' because it has a __init__ constructor (from: tests/files/handlers/test_file_handler_base.py)
    class TestHandler(BaseFileHandler):

tests/files/test_file_operations.py:12
  /home/pimentel/Workspace/pepperpy/tests/files/test_file_operations.py:12: PytestCollectionWarning: cannot collect test class 'TestHandler' because it has a __init__ constructor (from: tests/files/test_file_operations.py)
    class TestHandler:

tests/test_module.py:10
  /home/pimentel/Workspace/pepperpy/tests/test_module.py:10: PytestCollectionWarning: cannot collect test class 'TestModuleConfig' because it has a __init__ constructor (from: tests/test_module.py)
    class TestModuleConfig(BaseModel):

tests/test_module.py:19
  /home/pimentel/Workspace/pepperpy/tests/test_module.py:19: PytestCollectionWarning: cannot collect test class 'TestModule' because it has a __init__ constructor (from: tests/test_module.py)
    class TestModule(BaseModule[TestModuleConfig]):

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html

---------- coverage: platform linux, python 3.12.0-final-0 -----------
Name                                                        Stmts   Miss  Cover   Missing
-----------------------------------------------------------------------------------------
pepperpy/__init__.py                                            7      3    57%   9-11
pepperpy/ai/__init__.py                                         5      0   100%
pepperpy/ai/agents/__init__.py                                 13      0   100%
pepperpy/ai/agents/analysis.py                                 68     20    71%   27, 63, 68, 113-114, 118-119, 149-150, 170-171, 179, 195-212
pepperpy/ai/agents/architect.py                                18      1    94%   43
pepperpy/ai/agents/base.py                                     41      4    90%   28, 33, 38, 77
pepperpy/ai/agents/development.py                              16      1    94%   60
pepperpy/ai/agents/factory.py                                  21      0   100%
pepperpy/ai/agents/interfaces.py                               70     16    77%   17, 22, 27, 39, 52, 57, 62, 75, 80, 85, 103, 121, 139, 157, 175, 193
pepperpy/ai/agents/management.py                               56      4    93%   15, 62, 103, 144
pepperpy/ai/agents/qa.py                                       16      0   100%
pepperpy/ai/agents/research.py                                 27      0   100%
pepperpy/ai/agents/researcher.py                               16      0   100%
pepperpy/ai/agents/review.py                                   21      1    95%   59
pepperpy/ai/agents/reviewer.py                                 16      0   100%
pepperpy/ai/agents/specialized.py                              64      4    94%   15, 56, 138, 179
pepperpy/ai/agents/team.py                                     37      4    89%   39, 52-54
pepperpy/ai/agents/team_types.py                               59      3    95%   82, 84, 86
pepperpy/ai/agents/types.py                                    41      0   100%
pepperpy/ai/cache.py                                           45      6    87%   61-62, 68-69, 75-76
pepperpy/ai/chat/__init__.py                                    3      0   100%
pepperpy/ai/chat/config.py                                     31      0   100%
pepperpy/ai/chat/conversation.py                               43      0   100%
pepperpy/ai/chat/types.py                                      42      0   100%
pepperpy/ai/client.py                                          21     10    52%   15-16, 21, 26, 30-32, 41-43, 50-52
pepperpy/ai/config.py                                          16     16     0%   3-28
pepperpy/ai/config/__init__.py                                  3      0   100%
pepperpy/ai/config/agent.py                                     9      0   100%
pepperpy/ai/config/client.py                                   13      0   100%
pepperpy/ai/config/provider.py                                 49     49     0%   3-81
pepperpy/ai/config/team.py                                     14     14     0%   3-29
pepperpy/ai/embeddings/__init__.py                              4      4     0%   3-7
pepperpy/ai/embeddings/base.py                                 15     15     0%   3-30
pepperpy/ai/embeddings/client.py                               20     20     0%   3-36
pepperpy/ai/embeddings/config.py                               22     22     0%   3-38
pepperpy/ai/embeddings/exceptions.py                            5      5     0%   3-18
pepperpy/ai/embeddings/providers/__init__.py                   14     14     0%   3-30
pepperpy/ai/embeddings/providers/base.py                        6      6     0%   3-15
pepperpy/ai/embeddings/providers/sentence_transformers.py      16     16     0%   3-30
pepperpy/ai/embeddings/types.py                                13     13     0%   3-23
pepperpy/ai/exceptions.py                                       4      4     0%   3-14
pepperpy/ai/functions.py                                       26     26     0%   3-45
pepperpy/ai/llm/__init__.py                                     2      2     0%   3-5
pepperpy/ai/llm/client.py                                      40     40     0%   3-62
pepperpy/ai/llm/config.py                                      30     30     0%   3-45
pepperpy/ai/llm/exceptions.py                                   7      7     0%   4-21
pepperpy/ai/llm/factory.py                                     19     19     0%   3-63
pepperpy/ai/llm/types.py                                       21     21     0%   3-37
pepperpy/ai/module.py                                           2      2     0%   3-6
pepperpy/ai/providers/__init__.py                               4      4     0%   3-7
pepperpy/ai/providers/anthropic.py                             59     59     0%   3-136
pepperpy/ai/providers/base.py                                  18     18     0%   3-32
pepperpy/ai/providers/config.py                                14     14     0%   3-26
pepperpy/ai/providers/exceptions.py                             5      5     0%   3-18
pepperpy/ai/providers/factory.py                               12     12     0%   3-20
pepperpy/ai/providers/openai.py                                63     63     0%   3-148
pepperpy/ai/providers/openrouter.py                            68     68     0%   3-143
pepperpy/ai/providers/stackspot.py                             69     69     0%   3-158
pepperpy/ai/providers/types.py                                 24     24     0%   3-35
pepperpy/ai/roles.py                                           12      0   100%
pepperpy/ai/teams/__init__.py                                   6      6     0%   3-9
pepperpy/ai/teams/autogen/__init__.py                           2      2     0%   3-5
pepperpy/ai/teams/autogen/team.py                              13     13     0%   3-29
pepperpy/ai/teams/base.py                                      14     14     0%   3-27
pepperpy/ai/teams/config.py                                    14     14     0%   3-29
pepperpy/ai/teams/crew/__init__.py                              2      2     0%   3-5
pepperpy/ai/teams/crew/team.py                                 21     21     0%   3-60
pepperpy/ai/teams/factory.py                                   24     24     0%   3-46
pepperpy/ai/teams/interfaces.py                                33     33     0%   3-67
pepperpy/ai/teams/langchain/__init__.py                         2      2     0%   3-5
pepperpy/ai/teams/langchain/team.py                            13     13     0%   3-29
pepperpy/ai/teams/manager.py                                   34     34     0%   3-62
pepperpy/ai/teams/providers/__init__.py                         6      6     0%   3-9
pepperpy/ai/teams/providers/autogen.py                         17     17     0%   3-42
pepperpy/ai/teams/providers/base.py                            34     34     0%   3-56
pepperpy/ai/teams/providers/config.py                          15     15     0%   3-27
pepperpy/ai/teams/providers/crew.py                            33     33     0%   3-82
pepperpy/ai/teams/providers/langchain.py                       17     17     0%   3-42
pepperpy/ai/teams/types.py                                     17     17     0%   3-32
pepperpy/ai/templates.py                                       42     42     0%   3-74
pepperpy/ai/text/__init__.py                                    7      7     0%   3-16
pepperpy/ai/text/analyzer.py                                   41     41     0%   3-71
pepperpy/ai/text/chunker.py                                    33     33     0%   3-63
pepperpy/ai/text/config.py                                     16     16     0%   3-27
pepperpy/ai/text/exceptions.py                                  6      6     0%   3-22
pepperpy/ai/text/processor.py                                  30     30     0%   3-57
pepperpy/ai/text/types.py                                      16     16     0%   3-31
pepperpy/ai/types.py                                           34      0   100%
pepperpy/codebase/__init__.py                                   5      5     0%   3-8
pepperpy/codebase/config.py                                    15     15     0%   3-27
pepperpy/codebase/engine.py                                    11     11     0%   3-21
pepperpy/codebase/indexer.py                                   32     32     0%   3-54
pepperpy/codebase/metrics/__init__.py                           5      5     0%   3-8
pepperpy/codebase/parser/__init__.py                            4      4     0%   3-7
pepperpy/codebase/parser/ast.py                                34     34     0%   3-63
pepperpy/codebase/parser/imports.py                            26     26     0%   3-48
pepperpy/codebase/parser/types.py                               8      8     0%   3-15
pepperpy/codebase/providers/__init__.py                         5      5     0%   3-8
pepperpy/codebase/providers/analysis.py                        61     61     0%   3-100
pepperpy/codebase/providers/base.py                            23     23     0%   3-44
pepperpy/codebase/providers/hybrid.py                          27     27     0%   3-47
pepperpy/codebase/providers/llm.py                             33     33     0%   3-62
pepperpy/codebase/providers/static.py                          61     61     0%   3-100
pepperpy/codebase/providers/types.py                            5      5     0%   3-11
pepperpy/codebase/transforms/__init__.py                        4      4     0%   3-7
pepperpy/console/__init__.py                                    3      3     0%   3-16
pepperpy/console/base/__init__.py                               4      4     0%   3-7
pepperpy/console/base/app.py                                   33     33     0%   3-50
pepperpy/console/base/config.py                                 8      8     0%   3-13
pepperpy/console/base/console.py                               22     22     0%   3-45
pepperpy/console/config.py                                     35     35     0%   3-54
pepperpy/console/console.py                                    17     17     0%   3-36
pepperpy/console/legacy.py                                     39     39     0%   3-60
pepperpy/console/rich/__init__.py                               4      4     0%   3-7
pepperpy/console/rich/app.py                                   17     17     0%   3-32
pepperpy/console/rich/config.py                                15     15     0%   3-21
pepperpy/console/rich/console.py                               25     25     0%   3-58
pepperpy/console/rich/exceptions.py                             1      1     0%   1
pepperpy/console/rich/types.py                                 13     13     0%   3-24
pepperpy/console/ui/__init__.py                                11     11     0%   3-14
pepperpy/console/ui/app.py                                     25     25     0%   4-38
pepperpy/console/ui/components/__init__.py                     14     14     0%   3-17
pepperpy/console/ui/components/base.py                         17     17     0%   3-30
pepperpy/console/ui/components/button.py                       27     27     0%   3-47
pepperpy/console/ui/components/chat.py                         25     25     0%   3-60
pepperpy/console/ui/components/dialog.py                       21     21     0%   3-41
pepperpy/console/ui/components/form.py                         24     24     0%   3-46
pepperpy/console/ui/components/input.py                        50     50     0%   3-84
pepperpy/console/ui/components/layout.py                       48     48     0%   3-84
pepperpy/console/ui/components/list.py                         28     28     0%   3-49
pepperpy/console/ui/components/menu.py                         55     55     0%   3-99
pepperpy/console/ui/components/panel.py                        31     31     0%   3-79
pepperpy/console/ui/components/progress.py                     26     26     0%   3-45
pepperpy/console/ui/components/table.py                        47     47     0%   3-111
pepperpy/console/ui/components/toast.py                        26     26     0%   3-50
pepperpy/console/ui/config.py                                  12     12     0%   3-18
pepperpy/console/ui/screen.py                                  54     54     0%   3-95
pepperpy/console/ui/styles.py                                  17     17     0%   3-26
pepperpy/core/__init__.py                                       4      0   100%
pepperpy/core/cache/__init__.py                                 6      0   100%
pepperpy/core/cache/base.py                                    71     22    69%   36, 41, 46, 51, 56, 61, 66, 73, 77-79, 83-85, 90, 94-95, 100, 105, 110, 115, 120
pepperpy/core/cache/distributed.py                             78     13    83%   48-49, 61, 70, 76, 82, 98, 104, 108-109, 115, 119-120
pepperpy/core/cache/exceptions.py                               5      0   100%
pepperpy/core/cache/lru.py                                     45     30    33%   23-24, 37-44, 55-62, 72-76, 80-83, 88, 92, 96
pepperpy/core/cache/memory.py                                  42     29    31%   16, 29-40, 52-58, 68-72, 76-79, 83, 89
pepperpy/core/cache/strategies.py                               9      0   100%
pepperpy/core/config/__init__.py                                4      0   100%
pepperpy/core/config/config.py                                 13     13     0%   3-23
pepperpy/core/config/exceptions.py                              5      0   100%
pepperpy/core/config/manager.py                                20      3    85%   25, 30, 34
pepperpy/core/config/settings.py                               57      1    98%   49
pepperpy/core/config/types.py                                  25      0   100%
pepperpy/core/context.py                                       24     24     0%   3-49
pepperpy/core/db/__init__.py                                    3      0   100%
pepperpy/core/db/config.py                                     18      3    83%   25-27
pepperpy/core/db/vector.py                                     19      3    84%   26-28
pepperpy/core/dev/__init__.py                                   2      2     0%   3-5
pepperpy/core/dev/benchmark.py                                 41     41     0%   3-87
pepperpy/core/dev/debugger.py                                  60     60     0%   3-128
pepperpy/core/dev/mock.py                                      31     31     0%   3-66
pepperpy/core/dev/mocks.py                                     67     67     0%   3-122
pepperpy/core/dev/profiler.py                                  33     33     0%   3-64
pepperpy/core/dev/testing.py                                   27     27     0%   3-49
pepperpy/core/events.py                                        33     33     0%   3-65
pepperpy/core/exceptions/__init__.py                            5      0   100%
pepperpy/core/exceptions/base.py                                6      0   100%
pepperpy/core/exceptions/cache.py                               5      0   100%
pepperpy/core/exceptions/config.py                              5      0   100%
pepperpy/core/exceptions/validation.py                          4      0   100%
pepperpy/core/logging/__init__.py                               4      4     0%   3-7
pepperpy/core/logging/config.py                                35     35     0%   3-54
pepperpy/core/logging/exceptions.py                             5      5     0%   3-18
pepperpy/core/logging/formatters.py                            21     21     0%   3-53
pepperpy/core/logging/handlers.py                              46     46     0%   3-91
pepperpy/core/logging/logger.py                                40     40     0%   3-78
pepperpy/core/logging/types.py                                 20     20     0%   3-30
pepperpy/core/metrics/__init__.py                              18     18     0%   3-34
pepperpy/core/metrics/types.py                                 17     17     0%   3-27
pepperpy/core/module.py                                        33      2    94%   41, 46
pepperpy/core/plugins/__init__.py                              14     14     0%   3-28
pepperpy/core/plugins/config.py                                15     15     0%   3-27
pepperpy/core/plugins/decorators.py                            15     15     0%   3-68
pepperpy/core/plugins/exceptions.py                             5      5     0%   3-18
pepperpy/core/plugins/manager.py                               54     54     0%   3-89
pepperpy/core/plugins/types.py                                 16     16     0%   3-32
pepperpy/core/resources.py                                     38     38     0%   3-112
pepperpy/core/security/__init__.py                              5      5     0%   3-8
pepperpy/core/security/auth.py                                 19     19     0%   3-34
pepperpy/core/security/config.py                               13     13     0%   3-24
pepperpy/core/security/context.py                              14     14     0%   3-27
pepperpy/core/security/context_manager.py                       7      7     0%   3-17
pepperpy/core/security/decorators.py                           47     47     0%   3-73
pepperpy/core/security/exceptions.py                            6      6     0%   3-22
pepperpy/core/security/security_manager.py                     20     20     0%   3-37
pepperpy/core/security/types.py                                40     40     0%   3-63
pepperpy/core/serialization.py                                 56     56     0%   3-131
pepperpy/core/state.py                                         27     27     0%   3-83
pepperpy/core/tasks.py                                         58     58     0%   3-126
pepperpy/core/telemetry/__init__.py                            16     16     0%   3-30
pepperpy/core/telemetry/health.py                              59     59     0%   3-129
pepperpy/core/telemetry/metrics.py                             39     39     0%   3-105
pepperpy/core/telemetry/performance.py                         39     39     0%   3-104
pepperpy/core/telemetry/tracing.py                             41     41     0%   3-121
pepperpy/core/telemetry/types.py                               24     24     0%   3-35
pepperpy/core/types.py                                         12      2    83%   22-23
pepperpy/core/validation/__init__.py                            4      4     0%   3-7
pepperpy/core/validation/base.py                               20     20     0%   3-39
pepperpy/core/validation/exceptions.py                          4      4     0%   3-14
pepperpy/core/validation/factory.py                            11     11     0%   3-22
pepperpy/core/validation/transformer.py                        44     44     0%   3-95
pepperpy/core/validation/types.py                               7      7     0%   3-12
pepperpy/core/validation/validators.py                         24     24     0%   3-50
pepperpy/db/__init__.py                                         6      6     0%   3-9
pepperpy/db/client.py                                          26     26     0%   3-44
pepperpy/db/config.py                                          15     15     0%   3-24
pepperpy/db/engines/__init__.py                                13     13     0%   3-22
pepperpy/db/engines/base.py                                    22     22     0%   3-41
pepperpy/db/engines/duckdb.py                                  53     53     0%   3-97
pepperpy/db/engines/postgres.py                                57     57     0%   3-112
pepperpy/db/engines/sqlite.py                                  62     62     0%   3-108
pepperpy/db/exceptions.py                                       9      9     0%   4-32
pepperpy/db/types.py                                            8      8     0%   3-14
pepperpy/db/vector/__init__.py                                  5      5     0%   3-8
pepperpy/db/vector/config.py                                   11     11     0%   3-22
pepperpy/db/vector/engine.py                                   73     73     0%   3-158
pepperpy/db/vector/exceptions.py                                5      5     0%   3-18
pepperpy/db/vector/types.py                                    29     29     0%   3-52
pepperpy/files/__init__.py                                      5      0   100%
pepperpy/files/base.py                                         18      6    67%   17, 21, 25, 33, 44-45
pepperpy/files/config.py                                       22      4    82%   19, 21, 23, 36
pepperpy/files/constants.py                                     3      3     0%   3-6
pepperpy/files/exceptions.py                                    4      0   100%
pepperpy/files/handlers/__init__.py                            11      0   100%
pepperpy/files/handlers/audio.py                               29      5    83%   20, 35-38, 60
pepperpy/files/handlers/base.py                                55      8    85%   19, 24, 29, 34, 39, 62, 102, 116
pepperpy/files/handlers/binary.py                              28      5    82%   47-48, 66, 70-71
pepperpy/files/handlers/compression.py                         34     34     0%   3-55
pepperpy/files/handlers/config.py                              23     23     0%   3-42
pepperpy/files/handlers/config_handler.py                      22     22     0%   3-40
pepperpy/files/handlers/csv.py                                 71      9    87%   22, 27, 39, 49, 57, 61, 99-100, 124
pepperpy/files/handlers/document.py                            22     22     0%   3-42
pepperpy/files/handlers/epub.py                                76     76     0%   3-180
pepperpy/files/handlers/image.py                               25     25     0%   3-53
pepperpy/files/handlers/json.py                                33      4    88%   50-51, 69, 74
pepperpy/files/handlers/markdown.py                            26      4    85%   47-48, 67-68
pepperpy/files/handlers/markdown_enhanced.py                   22     22     0%   3-41
pepperpy/files/handlers/markup.py                              22     22     0%   3-40
pepperpy/files/handlers/media.py                               23     23     0%   3-49
pepperpy/files/handlers/optimizer.py                           81     15    81%   41, 43, 48, 72-73, 86-89, 94, 108, 114-115, 121, 124
pepperpy/files/handlers/pdf.py                                 32      1    97%   69
pepperpy/files/handlers/spreadsheet.py                         22     22     0%   3-40
pepperpy/files/handlers/text.py                                33      9    73%   48-51, 70, 76-79
pepperpy/files/handlers/yaml.py                                50      7    86%   21, 26, 31, 74-75, 100-101
pepperpy/files/manager.py                                      51      1    98%   108
pepperpy/files/types.py                                       101     10    90%   48, 50, 52, 54, 56, 58, 60, 75, 91, 144
pepperpy/files/utils.py                                         5      5     0%   3-10
pepperpy/network/__init__.py                                    5      5     0%   3-12
pepperpy/network/client.py                                     32     32     0%   3-54
pepperpy/network/config.py                                     10     10     0%   3-19
pepperpy/network/exceptions.py                                  9      9     0%   3-34
pepperpy/network/types.py                                      27     27     0%   3-49
pepperpy/pipelines/__init__.py                                  3      3     0%   3-13
pepperpy/pipelines/base.py                                     12     12     0%   3-25
pepperpy/pipelines/types.py                                    32     32     0%   3-63
pepperpy/pipelines/validation.py                                6      6     0%   3-12
-----------------------------------------------------------------------------------------
TOTAL                                                        6508   4782    27%

=========================== short test summary info ============================
FAILED tests/files/handlers/test_audio.py::test_audio_handler_write - Attribu...
FAILED tests/files/handlers/test_audio.py::test_audio_handler_invalid_content
FAILED tests/files/handlers/test_audio.py::test_audio_handler_unsupported_format
FAILED tests/files/handlers/test_audio.py::test_audio_handler_empty_content
FAILED tests/files/handlers/test_csv.py::test_csv_handler_read_with_custom_delimiter
FAILED tests/files/handlers/test_csv.py::test_csv_handler_write_with_custom_delimiter
FAILED tests/files/handlers/test_csv.py::test_csv_handler_read_with_custom_encoding
FAILED tests/files/handlers/test_csv.py::test_csv_handler_write_with_custom_encoding
FAILED tests/files/handlers/test_csv.py::test_csv_handler_write_with_quoting
FAILED tests/files/handlers/test_csv.py::test_csv_handler_write_invalid_path
================== 10 failed, 257 passed, 8 warnings in 2.63s ==================
